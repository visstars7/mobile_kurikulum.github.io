<!DOCTYPE HTML>
<span lang="en">

    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
        <meta name="viewport"
            content="width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=1, viewport-fit=cover" />
        <title>Kurikulum Mobile</title>
        <link rel="stylesheet"
            href="https://fonts.googleapis.com/css?family=Poppins:200,200i,300,300i,400,400i,500,500i,600,600i,700,700i,800,800i,900,900i|Roboto:300,300i,400,400i,500,500i,700,700i,900,900i&display=swap">
        <link rel="stylesheet" type="text/css" href="../../styles/style.css">
        <link rel="stylesheet" type="text/css" href="../../styles/framework.css">
        <link rel="stylesheet" type="text/css" href="../../fonts/css/fontawesome-all.min.css">
        <link rel="apple-touch-icon" sizes="180x180" href="../../app/icons/icon-192x192.png">
        <link rel="manifest" href="../../manifest.json">
        <script src="../../scripts/sessionCheck.js"></script>
    </head>

    <body class="theme-light" data-highlight="blue2">

        <div id="page">

            <div id="page-preloader">
                <div class="loader-main loader-inactive">
                    <div class="preload-spinner border-highlight"></div>
                </div>
            </div>

            <div class="header header-fixed header-logo-app header-auto-show">
                <a href="index.html" class="header-title">KURIKULUM</a>
                <a href="#" data-menu="menu-main" class="header-icon header-icon-1"><i class="fas fa-bars"></i></a>
                <a href="#" data-toggle-theme="" class="header-icon header-icon-2"><i class="fas fa-lightbulb"></i></a>
                <a href="#" data-menu="menu-highlights" class="header-icon header-icon-3"><i
                        class="fas fa-brush"></i></a>
            </div>


            <div class="page-content">

                <div class="page-title-large color-white bottom-30">
                    <h1 data-username="Enabled!" class="greeting-text" id="greeting-name">Good evening,<br>Enabled!</h1>
                </div>
                <div data-height="210" class="page-title-bg preload-image"
                    data-src="https://daily.jstor.org/wp-content/uploads/2018/08/punch_jack_ripper_cartoon_2_1050x700.jpg"
                    style="height: 210px; background-image:
                    url(&quot;https://daily.jstor.org/wp-content/uploads/2018/08/punch_jack_ripper_cartoon_2_1050x700.jpg&quot;);">
                    <!-- image -->
                </div>

                <div data-height="210" class="page-title-bg dark-mode-tint" style="height: 210px;">
                    <!-- contrast for dark mode -->
                </div>
                <div data-height="210" class="page-title-bg opacity-90 bg-highlight" style="height: 210px;">
                    <!-- background color -->
                </div>
                <div class="content-boxed shadow-small">
                    <h3 id="nama_materi" style="padding:20px"><i class="fas fa-school right-20"></i></h3>
                    <div class="one-half">
                        <a onlick="location.reload()"
                            class="left-15 button button-xs round-small shadow-large bg-blue2-dark button-full bottom-30"><i
                                class="fas fa-sync right-10"></i>Refresh</a>
                    </div>
                    <div class="one-half last-column">
                        <a href="./pjj.html" class="right-15 button button-xs round-small shadow-large button-border button-full
                            border-blue2-dark color-theme bg-transparent bottom-0"><i
                                class="fas fa-sign-out-alt right-10"></i>Kembali</a>
                    </div>
                </div>
                <div class="content-boxed content-boxed-full shadow-large" id="content-1">
                </div>
                <div class="content-boxed content-boxed-full shadow-large">
                    <div class="content bottom-0">
                        <h5 class="top-5 bottom-5" style="padding: 10px;"> Form Penyerahan</h5>

                        <form id="theForm">
                            <div class="input-style input-style-2 input-required">
                                <input name="tipe_penyerahan" type="hidden" id="tipe-penyerahan" placeholder="">
                            </div>
                            <div id="form"></div>
                        </form>
                        <div class="one-half top-25">
                            <a style="z-index:999" href="#"
                                class="button button-m shadow-small button-round-small bg-magenta1-dark bottom-30 button-full"
                                onclick="upload()"><i class="fas fa-cloud-upload-alt right-10"></i>File
                                Upload</a>
                        </div>
                        <div class="one-half last-column top-25">
                            <a style="z-index:999" id="link" href="#"
                                class="button button-m shadow-small button-round-small bg-pink1-dark bottom-30 button-full"
                                onclick="link()"><i class="	fas fa-code right-10"></i>Links</a>
                        </div>

                        <div class="top-25">
                            <a href="#"
                                class="button button-m shadow-small button-round-small bg-green2-dark bottom-30 button-full"
                                onclick="send()"><i class="fas fa-paper-plane right-10"></i>Kirim</a>
                        </div>
                    </div>
                </div>
                <div id="tugas">
                </div>
            </div>

            <!-- Footer Menu-->
            <div id="footer-menu" class="footer-menu-5-icons footer-menu-style-1">
                <a href="pjj.html" class="active-nav4">
                    <i class="fas fa-chalkboard-teacher" aria-hidden="true" data-feather-bg="blue2-fade-dark"></i>
                    <span>PJJ</span>
                    <strong></strong></a>
                <a href="home.html">
                    <i class="fas fa-user-alt" aria-hidden="true" data-feather-bg="blue2-fade-dark"></i>
                    <span>My Profile</span>
                    <strong></strong></a>
                <a href="#">
                    <i class="fas fa-book-reader" aria-hidden="true" data-feather-bg="blue2-fade-dark"></i>
                    <span>E-book</span>
                    <strong></strong></a>

                <a href="#">
                    <i class="fas fa-calendar-alt" aria-hidden="true" data-feather-bg="blue2-fade-dark"></i>
                    <span>Penjadwalan</span>
                    <strong></strong></a>
                <a href="#">
                    <i class="fas fa-stream" aria-hidden="true" data-feather-bg="blue2-fade-dark"></i>
                    <span>More Menu</span>
                    <strong></strong></a>
            </div>

            <!-- Main Sidebar Menu-->
            <div id="menu-main" class="menu menu-box-right menu-box-detached round-medium"
                data-menu-active="nav-welcome" data-menu-width="260" data-menu-effect="menu-over"
                data-menu-load="menu-main.html" style="width: 260px;">
            </div>

            <!-- Share Menu-->
            <div id="menu-share" class="menu menu-box-bottom menu-box-detached round-medium" data-menu-height="400"
                data-menu-effect="menu-over" data-menu-load="menu-share.html" style="height: 400px;">
            </div>

            <!-- Color Highlights Menu-->
            <div id="menu-highlights" class="menu menu-box-bottom menu-box-detached round-medium" data-menu-height="480"
                data-menu-effect="menu-over" data-menu-load="menu-colors.html" style="height: 480px;">
            </div>


            <!-- Be sure this is on your main visiting page, for example, the index.html page-->
            <!-- These modals will asure your page fires the PWA install notification boxes-->
            <!-- Install Prompt for Android -->
            <div id="menu-install-pwa-android" class="menu menu-box-bottom menu-box-detached round-large"
                data-menu-height="340" data-menu-effect="menu-parallax" style="height: 340px;">
                <div class="boxed-text-huge top-25">
                    <img class="round-medium preload-image center-horizontal" data-src="" alt="img" width="90">
                    <h4 class="center-text bolder top-20 bottom-10">Add Azures on your Home Screen</h4>
                    <p>
                        Install Azures on your home screen, and access it just like a regular app. It really is that
                        simple!
                    </p>
                    <a href="#"
                        class="pwa-install button button-xs button-round-medium button-center-large shadow-large bg-highlight bottom-0">Add
                        to Home Screen</a><br>
                    <a href="#"
                        class="pwa-dismiss close-menu center-text color-gray2-light uppercase ultrabold opacity-60 under-heading font-10">Maybe
                        later</a>
                    <div class="clear"></div>
                </div>
            </div>

            <!-- Install instructions for iOS -->
            <div id="menu-install-pwa-ios" class="menu menu-box-bottom menu-box-detached round-large"
                data-menu-height="320" data-menu-effect="menu-parallax" style="height: 320px;">
                <div class="boxed-text-huge top-25">
                    <img class="round-medium preload-image center-horizontal"
                        data-src="../../app/icons/icon-128x128.png" alt="img" width="90">
                    <h4 class="center-text bolder top-20 bottom-10">Add Azures on your Home Screen</h4>
                    <p class="bottom-15">
                        Install Azures on your home screen, and access it just like a regular app. Open your Safari menu
                        and
                        tap "Add to Home Screen".
                    </p>
                    <div class="clear"></div>
                    <a href="#"
                        class="pwa-dismiss close-menu center-text color-highlight uppercase ultrabold opacity-80 top-25">Maybe
                        later</a>
                    <i class="fa-ios-arrow fa fa-caret-down font-40"></i>
                </div>
            </div>
            <div class="menu-hider"></div>
            <p class="offline-message bg-red2-dark color-white center-text uppercase ultrabold">No internet connection
                detected
            </p>
            <p class="online-message bg-green1-dark color-white center-text uppercase ultrabold">You are back online.
                Welcome!
            </p>
        </div>
        <script type="text/javascript" src="../../scripts/jquery.js"></script>
        <script type="text/javascript" src="../../scripts/apiServices.js"></script>
        <script type="text/javascript" src="../../js/register-worker.js"></script>
        <script type="text/javascript" src="../../scripts/plugins.js"></script>
        <script type="text/javascript" src="../../scripts/custom.js"></script>
        <script type="text/javascript" src="../../scripts/getProfile.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/sweetalert2@10"></script>

        <script>
            $(document).ready(() => {
                // greeting
                var name = localStorage.getItem('nama');
                var nip = localStorage.getItem('nip');
                var role = localStorage.getItem('role');
                var id_kelas = localStorage.getItem('id_kelas');
                var id_materi = localStorage.getItem('id_materi');
                $("#greeting-name").attr('data-username', name);

                var API = `${endpoint}api-materi/get_materi`;

                post = new FormData();

                post.append('db', 'db');
                post.append('tb', 'v_materi_pjj');
                post.append('id_materi', id_materi);

                fetch(API, {
                        method: 'post',
                        mode: 'cors',
                        credentials: 'omit',
                        body: post
                    }).then(res => res.json())
                    .then((data) => {
                        var materi = data[0];
                        $("#nama_materi").append(materi['nama_mapel']);
                        if (materi.tipe_file == 1) {

                            var content1 = `<div class="content bottom-0">
                            <h5 class="top-10">${materi['nama_kelas']} - ${materi['nama_mapel']}</h5>
                            <p style="margin-bottom:3px">Batas Penyerahan : <span>${materi['waktu_penyerahan']}</span></p>
                            <p>Guru: ${materi.nama_guru}</p>
                            <p id="keterangan">${materi.keterangan}</p>
                            <a href="${materi.file}"
                                class="button button-m shadow-small button-round-small bg-green2-dark button-full bottom-30" download><i
                                    class="fas fa-download right-10"></i>Download</a>
                        </div>`;
                        } else {
                            var content1 = `<div class="content bottom-0">
                                <h5 class="top-10">${materi['nama_kelas']} - ${materi['nama_mapel']}</h5>
                                <p style="margin-bottom:3px">Batas Penyerahan :
                                    <span>${materi['waktu_penyerahan']}</span></p>
                                <p>Guru: ${materi.nama_guru}</p>
                                <p id="keterangan">${materi.keterangan}</p>
                                <div class="one" id="bentuk-materi">
                                    <div class="input-style input-style-2 input-required">
                                        <a target="_blank" href="${materi.file}"
                                            class="button button-m shadow-small button-round-small bg-green2-dark button-full bottom-30"
                                            download><i class="far fa-hand-point-up right-10"></i>Kunjungi</a>
                                </div>
                            </div>`;
                        }

                        $("#content-1").html(content1);
                    }).catch((err) => {
                        swal.fire({
                            title: 'Error Fetching',
                            text: 'Please Contact Admin',
                            icon: 'error',
                            confirmButtonText: 'close'
                        });
                    });

            });

            function link() {
                $("#tipe-penyerahan").val(2);
                $("#form").html(` <div id="tipe-penyerahan" class="input-style input-style-2 input-required">
                    <input id="file" type="url" placeholder="links" autocomplete="off" name=file style="z-index:999">
                </div>`);
            }

            function upload() {
                $("#tipe-penyerahan").val(1);
                $("#form").html(` <div class="file-data top-10">
                    <input type="file" id="file"
                        class="upload-file button bg-highlight button-full shadow-small round-small button-xs "
                        accept="image/*" name="file">
                    <p class="upload-file-text">Upload Image</p>
                </div>`);

            }

            function send() {
                var formData = new FormData();
                var nisn = localStorage.getItem('nip');
                var id_materi = localStorage.getItem('id_materi');
                var tipe = $("#tipe-penyerahan").val();
                var API = `${endpoint}api-penyerahan/store`;

                if (tipe > 0) {

                    if (tipe == 1) {
                        var file = $("#file")[0].files[0];
                        console.log(file);
                    } else {
                        var file = $("#file").val();
                    }

                    formData.append('nisn', nisn);
                    formData.append('id_materi_pjj', id_materi);
                    formData.append('tipe_penyerahan', tipe);
                    formData.append('file', file);

                    fetch(API, {
                            method: 'post',
                            mode: 'cors',
                            credentials: 'omit',
                            body: formData
                        }).then(res => res.json())
                        .then((data) => {
                            if (data.status == 200) {
                                swal.fire({
                                    title: 'Success',
                                    text: 'telah menyerahkan jawaban',
                                    icon: 'success',
                                    confirmButtonText: 'close'
                                }).then(() => {
                                    location.href = "pjj.html";
                                });
                            } else {
                                swal.fire({
                                    title: 'Cek Kembali jawaban',
                                    text: 'insert your file / link',
                                    icon: 'warning',
                                    confirmButtonText: 'close'
                                })
                            }
                        }).catch((err) => {
                            console.log(err)
                        });
                } else {
                    swal.fire({
                        title: 'input 404',
                        text: 'insert your file / link',
                        icon: 'warning',
                        confirmButtonText: 'close'
                    });
                }

            }
        </script>
    </body>